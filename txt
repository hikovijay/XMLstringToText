import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class ExcelSearchAndUpdate {
    public static void main(String[] args) {
        String filePath = "your_excel_file.xlsx"; // Replace with the path to your Excel file

        try (FileInputStream fis = new FileInputStream(filePath);
             Workbook workbook = new XSSFWorkbook(fis)) {
            Sheet sheet = workbook.getSheetAt(0); // You can specify the sheet by index or name

            // Get the value from cell B2
            Row rowB2 = sheet.getRow(1); // B2 corresponds to row 2 (0-based index)
            Cell cellB2 = rowB2.getCell(1); // B2 corresponds to column B (0-based index)
            String valueB2 = cellB2.getStringCellValue();

            // Search for the value in column G (assuming it's a String column)
            for (int rowNum = 1; rowNum <= sheet.getLastRowNum(); rowNum++) {
                Row row = sheet.getRow(rowNum);
                Cell cellG = row.getCell(6); // Column G is index 6
                String valueG = cellG.getStringCellValue();

                // Compare valueB2 with valueG
                if (valueB2.equals(valueG) && rowNum < sheet.getLastRowNum()) {
                    // Get the value from the next line's column cell and update column D
                    Row nextRow = sheet.getRow(rowNum + 1);
                    Cell cellGNext = nextRow.getCell(6); // Column G in the next row
                    if (cellGNext.getCellType() == CellType.STRING) {
                        String valueD = cellGNext.getStringCellValue();

                        Cell cellD = row.createCell(3, CellType.STRING); // Column D is index 3
                        cellD.setCellValue(valueD);
                    }
                }
            }

            // Save the modified workbook
            try (FileOutputStream fos = new FileOutputStream(filePath)) {
                workbook.write(fos);
            }

            System.out.println("Search and update completed.");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
