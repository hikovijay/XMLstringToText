import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;

public class ExcelSearchAndUpdate {
    public static void main(String[] args) {
        String filePath = "your_excel_file.xlsx"; // Replace with the path to your Excel file

        try (FileInputStream fis = new FileInputStream(filePath);
             Workbook workbook = new XSSFWorkbook(fis)) {
            Sheet sheet = workbook.getSheetAt(0); // You can specify the sheet by index or name

            // Get the value from cell B2
            Row rowB2 = sheet.getRow(1); // B2 corresponds to row 2 (0-based index)
            Cell cellB2 = rowB2.getCell(1); // B2 corresponds to column B (0-based index)
            String valueB2 = cellB2.getStringCellValue();

            // Initialize a variable to track the matching row
            int matchingRow = -1;

            // Search for the value in column G (assuming it's a String column)
            for (int rowNum = 1; rowNum <= sheet.getLastRowNum(); rowNum++) {
                Row row = sheet.getRow(rowNum);
                Cell cellG = row.getCell(6); // Column G is index 6
                String valueG = cellG.getStringCellValue();

                // Compare valueB2 with valueG
                if (valueB2.equals(valueG)) {
                    matchingRow = rowNum;
                    break;
                }
            }

            // If a match is found, get the value from the next line's column cell and update column D
            if (matchingRow != -1 && matchingRow < sheet.getLastRowNum()) {
                Row nextRow = sheet.getRow(matchingRow + 1);
                Cell cellGNext = nextRow.getCell(6); // Column G in the next row
                if (cellGNext.getCellType() == CellType.STRING) {
                    String valueD = cellGNext.getStringCellValue();

                    Row rowD2 = sheet.getRow(1); // D2 corresponds to row 2 (0-based index)
                    Cell cellD2 = rowD2.createCell(3, CellType.STRING); // Column D is index 3
                    cellD2.setCellValue(valueD);
                }
            }

            // Save the modified workbook
            try (FileOutputStream fos = new FileOutputStream(filePath)) {
                workbook.write(fos);
            }

            System.out.println("Search and update completed.");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
