import org.testng.*;
import org.testng.annotations.*;
import org.apache.poi.ss.usermodel.*;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

import java.io.FileOutputStream;
import java.io.IOException;
import java.util.concurrent.ConcurrentHashMap;

public class TestClass {
    private static XSSFWorkbook workbook;
    private static XSSFSheet sheet;
    private static int rowIndex = 1;

    @BeforeSuite
    public void setUp() {
        workbook = new XSSFWorkbook();
        sheet = workbook.createSheet("TestResults");
        rowIndex = 1;
    }

    @AfterSuite
    public void tearDown() {
        try (FileOutputStream fos = new FileOutputStream("ConsolidatedTestResults.xlsx")) {
            workbook.write(fos);
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void testMethod1() {
        String value1 = "Value1";
        String value2 = "Value2";
        String value3 = "Value3";
        String value4 = "Value4";
        String value5 = "Value5";
        recordResult("Test Method 1", value1, value2, value3, value4, value5);
    }

    @Test
    public void testMethod2() {
        String value1 = "AnotherValue1";
        String value2 = "AnotherValue2";
        String value3 = "AnotherValue3";
        String value4 = "AnotherValue4";
        String value5 = "AnotherValue5";
        recordResult("Test Method 2", value1, value2, value3, value4, value5);
    }

    // Add more test methods as needed

    private void recordResult(String testName, String value1, String value2, String value3, String value4, String value5) {
        Row row = sheet.createRow(rowIndex++);
        row.createCell(0).setCellValue(testName);
        row.createCell(1).setCellValue(value1);
        row.createCell(2).setCellValue(value2);
        row.createCell(3).setCellValue(value3);
        row.createCell(4).setCellValue(value4);
        row.createCell(5).setCellValue(value5);
    }
}
