import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.apache.poi.ss.usermodel.Workbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

public class ExcelFileSearchAndUpload {

    public static void main(String[] args) {
        String folderPath = "/path/to/your/folder"; // Change this to the folder path you want to search
        List<String> excelFiles = new ArrayList<>();

        File folder = new File(folderPath);
        File[] files = folder.listFiles();

        if (files != null) {
            for (File file : files) {
                if (file.isFile() && file.getName().endsWith(".xlsx")) {
                    try (Workbook workbook = WorkbookFactory.create(file)) {
                        // If the workbook is successfully created, the file is a valid Excel file
                        excelFiles.add(file.getAbsolutePath());
                    } catch (IOException e) {
                        // If an exception occurs, the file is not a valid Excel file
                        e.printStackTrace(); // Handle the exception as needed
                    }
                }
            }
        }

        // Set the path to the ChromeDriver executable
        System.setProperty("webdriver.chrome.driver", "path/to/chromedriver");
        WebDriver driver = new ChromeDriver();

        // Assuming there is an input element on the web page to upload a file
        WebElement fileInput = driver.findElement(By.id("fileInputId"));

        // Loop through the Excel files and send each absolute path to the file input
        for (String filePath : excelFiles) {
            fileInput.sendKeys(filePath);
            // You may need to add a delay here to give the file upload process some time
            // For example: Thread.sleep(2000);
        }

        // Close the WebDriver
        driver.quit();
    }
}
